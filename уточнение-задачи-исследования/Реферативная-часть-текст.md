## Виды руткитов и методы противодействия им ##
Вредоносное программное обеспечение (ВПО) семейства rootkit представляет собой одну из наиболее 
угрожающих и хитрых форм кибератак. Определение и объяснение rootkit-ов в различных источниках могут незначительно
различаться. Важно отметить, что существует несколько типов rootkit-ов, каждый из которых использует свои уникальные 
техники и механизмы скрытия. Некоторые rootkit-ы могут проникать в операционную систему на уровне ядра (kernel-mode), 
изменяя ее функциональность и манипулируя системными вызовами. Другие могут внедряться на уровне приложений (user-mode)
и скрывать свои файлы и процессы от обычных методов обнаружения.  Некоторые определяют rootkit как набор инструментов и программных модулей, созданных для обеспечения 
скрытого и непрерывного доступа к системе, а также подавления и изменения нормального функционирования ее компонентов. 
Другие определения выделяют rootkit как комплекс программ и механизмов, позволяющих злоумышленникам получить 
привилегированный доступ к операционной системе, управлять ею и обойти средства обнаружения и защиты.
Так, например, в разных статьях приводятся следующие определения: </br>
В статье "ПРОБЛЕМА ОБЕЗВРЕЖИВАНИЯ РУТКИТОВ УРОВНЯ ЯДРА В СИСТЕМАХ СПЕЦИАЛЬНОГО НАЗНАЧЕНИЯ" Кирилловна Ксения Сергеевна,
Цветков Александр Юрьевич, Волкогонов Владимир Никитич дают следующее определение руткиту:
> Руткит (англ. Rootkit) — 
разновидность вредоносных программ, позволяющих злоумышленнику незаметно возвращаться во взломанную систему. 
Это понятие появилось в мире UNIX, где оно означает набор утилит или специальный модуль ядра, которые атакующий 
устанавливает на взломанной им компьютерной системе сразу после получения прав суперпользователя (корневого пользователя). </br>

В статье "ТЕХНОЛОГИЯ РУТКИТОВ И ОСОБЕННОСТИ ИХ ОБНАРУЖЕНИЯ" Бурмистров А.В., Якунина Ю.Ю. предлагают свой 
вариант определения:
> Руткиты - специальные механизмы, используемые вредоносным программным обеспечением (ВПО) для его стабильного и 
 неопределяемого присутствия в компьютерной системе, как для пользователя, так и для средств защиты.

В статье "Implementing Rootkits to Address Operating System Vulnerabilities" Corregedor Manuel, Von Solms Sebastiaa
приводят следующее определение:
>Руткит - это вредоносная программа или набор программ, которые пытаются скрыть свое существование на зараженном компьютере,
атакуя операционную систему (OS) с помощью одного или комбинации следующих действий: изменение бинарных файлов программы, 
Перехват таблиц вызовов, таких как Системная таблица дескрипторов служб (SSDT) и Таблица дескрипторов прерываний (IDT)
для перехвата потока управления ядром, модифицируя легитимный код для принудительного вызова руткит-кода
или используя DKOM (прямое манипулирование объектами ядра).

В статье "Position Paper: Consider Hardware-enhanced Defenses for Rootkit Attacks" авторы - Hu Guangyuan, Zhang Tianwei,
Lee Ruby B. дали следующее определение:
>Руткиты - это вредоносное программное обеспечение, которое пытается скомпрометировать функциональность системы, 
скрывая своё существование. Было предложено множество различных руткитов, а также различные программные защиты,
но лишь очень немногие аппаратные защиты.

В статье "Rootkits and Malicious Code Injection | Journal of Mobile, Embedded and Distributed Systems" Maris Vlad пишет следующее:
> Руткит можно рассматривать как набор программ, которые изменяют и заменяют существующие пути выполнения в системе.
> Этот процесс нарушает целостность системы. Википедия определяет руткит как "тип программного обеспечения,
> предназначенный для получения контроля на уровне администратора над компьютерной системой без обнаружения".


Прежде чем переходить к методам противодействия руткитам стоит разобраться с тем, чему мы противостоим,
сами механизмы работы руткитов делятся на несколько типов. 
В своей статье "Технологии сокрытия вредоносных программ и новые способы противодействия им" 
Коркин И. Ю. представляет хорошую схему классификации ВПО, выглядит она следующим образом:
- Механизмы сокрытия ВПО
  - Стенографические механизмы
  - Руткит-механизмы
    - Механизмы, работающие "внутри" ОС
      - Изменение пути выполнения
      - Изменение структуры памяти
    - Механизмы, работающие "вне" ОС
      - Механизмы, основанные на режиме VT
      - Механизмы, основанные на режиме SMM


Стенографические механизмы скрывают настоящее предназначение программы путём маскировки их под легитимные.
Конкретно для моей исследовательской работы интерес вызывают только руткит-механизмы.
Руткиты, работающие "внутри" ОС - основываются на изменении пути выполнения или на изменении структур памяти.
Руткиты, работающие "вне" ОС - Они представляют собой вредоносные программы, которые заражают компьютер или другое 
устройство еще до загрузки операционной системы. Это позволяет руткитам оперировать на уровне аппаратного обеспечения,
что делает их очень труднодоступными для обнаружения и удаления.</br>

В своей статье "ТЕХНОЛОГИЯ РУТКИТОВ И ОСОБЕННОСТИ ИХ ОБНАРУЖЕНИЯ" Бурмистров А.В. и Якунина Ю.Ю. так же разделяют руткиты
на две основных группы - работающие "внутри" ОС и работающие "вне" ОС. </br>

Для каждой из этих групп руткит-механизмов есть свои методы противодействия. Основная проблема, вызываемая руткитами - 
это их способность скрываться, из чего следует, что обнаружение руткита - это первый и, можно сказать, основной шаг в противодействии ему.
Методы противодействия rootkit-ам нацелены на быстрое обнаружение и эффективное устранение этих скрытых угроз.
Целью методов противодействия rootkit-ам является не только обнаружение и удаление самого rootkit-а, но и предотвращение
его повторного внедрения, а также минимизация возможных повреждений и ущерба, наносимого компьютерной системе.
При разработке эффективных методов противодействия следует учитывать разнообразие и сложность rootkit-ов, 
а также их способность адаптироваться к изменяющимся условиям и защитным механизмам. </br>

Существует несколько подходов к обнаружению вредоносных программ. В статье "A Comprehensive Review on Malware Detection Approaches"
Ömer Aslan, Samet Refik дают общее представление о существующих подходах к обнаружению руткитов. Они выделили 8 основных подходов:
- Основанный на сигнатурах
- Основанный на поведении
- Основанный на эвристике
- Основанный на проверке модели
- Построенный на основе глубокого изучения
- Основанный на облачных вычислениях
- Основанный на мобильных устройствах
- Основанный на интернете вещей


Основанный на сигнатурах: Этот подход использует базы данных сигнатур (уникальных характеристик) 
известных ВПО для обнаружения подобных угроз. Если обнаруживается сигнатура, совпадающая с определенным типом ВПО,
антивирусное программное обеспечение или система считает, что обнаружено ВПО.

Основанный на поведении: Этот подход анализирует поведение программ или системы в реальном времени и обнаруживает
аномальные или подозрительные действия, которые могут указывать на наличие ВПО. Он фокусируется на действиях, а не на конкретных сигнатурах.

Основанный на эвристике: Этот подход использует эвристические алгоритмы для поиска необычных или характерных характеристик, которые могут 
свидетельствовать о наличии ВПО. Он ищет паттерны и поведение, которые могут не быть определенными сигнатурами.

Основанный на проверке модели: Этот подход использует методы формальной верификации для проверки системы 
или программного обеспечения на соответствие заданным спецификациям или свойствам. Он позволяет автоматически 
проверить систему на наличие ошибок или уязвимостей на основе формальной модели ее поведения.

Построенный на основе глубокого обучения: Этот подход использует нейронные сети и методы глубокого обучения для обнаружения ВПО.
Он основан на анализе больших объемов данных и обучении модели для распознавания характерных признаков ВПО.

Основанный на облачных вычислениях: Этот подход использует облачные ресурсы и сервисы для обнаружения ВПО. Облачные 
вычисления позволяют эффективно обрабатывать и анализировать большие объемы данных для выявления потенциальных угроз.

Основанный на мобильных устройствах: Этот подход специализируется на обнаружении ВПО на мобильных устройствах, таких 
как смартфоны и планшеты. Он учитывает уникальные характеристики и уязвимости, связанные с мобильными платформами.

Основанный на интернете вещей: Этот подход направлен на обнаружение ВПО в системах и устройствах, связанных с Интернетом вещей.
Он учитывает особенности и уязвимости, связанные с интернетом вещей и обеспечивает безопасность таких устройств и систем.

Авторы статьи выделяют следующие преимущества и недостатки для каждого из подходов:
1. Основанный на сигнатурах
  - Плюсы:
    - Быстрый и эффективный для известных ВПО
    - Используется в течении многих лет
    - Эффективен для обнаружения ВПО, принадлежащих к одному семейству
  - Минусы:
    - Недостаточный, чтобы обнаруживать ВПО нового поколения
    - Чувствителен к ложным срабатываниям
    - Извлечение сигнатур тратит много времени
    - Уязвим к запутыванию и полиморфным методам
2. Основанный на поведении
   - Плюсы:
     - Определяет функциональность ВПО
     - Эффективен для обнаружения новых вредоносных программ
     - Эффективен для обнаружения различных вариантов одной и той же вредоносной программы
     - Эффективен против запутывания и полиморфных методов
   - Минусы:
     - Чувствителен к ложным срабатываниям
     - Сложность в групировке поведения как злонамеренное или нормальное, поскольку некоторые действия или операции, которые проявляются вредоносным
     программным обеспечением, могут также проявляться в обычных, не вредоносных образцах.
     - Невозможно узнать все варианты поведения
3. Основанный на эвристике
    - Плюсы:
      - Может обнаружить ранее неизвестные вредоносные программы
      - Может использовать как статические, так и динамические функции
    - Минусы:
      - Много правил и этапов обучения
      - Уязвим к метаморфическим подходам
4. Основанный на проверке модели
    - Плюсы:
      - Эффективен для обнаружения ВПО, принадлежащих к одному семейству
      - Эффективен против запутывания и полиморфных методов
    - Минусы:
      - Сложная и ресурсоемкая техника
      - Получает ограниченное представление о вредоносном ПО
      - Не удается обнаружить всё ВПО нового поколения
5. Построенный на основе глубокого обучения
    - Плюсы:
      - Мощный и эффективный
      - Значительно сокращает пространство для объектов
    - Минусы:
      - Уязвим к атакам-уклонениям(атака-уклонение - это техника, при которой злоумышленник предпринимает манипуляции с входными данными или образцами, чтобы обмануть модель и сделать ее неправильные предсказания или дать ложные результаты.)
      - Создание и обучение скрытых слоев нейронной сети может занимать значительное кол-во ресурсов и времени
6. Основанный на облачных вычислениях
    - Плюсы:
      - Повышает эффективность обнаружения на ПК и мобильных устройствах
      - Большие базы данных вредоносных программ и интенсивные вычислительные ресурсы
      - Легко доступный, управляемый и регулярно обновляемый
    - Минусы:
      - Отсутствует мониторинг в режиме реального времени
      - Может раскрыть некоторые конфиденциальные данные, такие как пароль и местоположение
      - Взаимодействие между клиентом и сервером
7. Основанный на мобильных устройствах
    - Плюсы:
      - Эффективен для обнаружения традиционных и новых вредоносных программ
      - Может использовать как статические, так и динамические функции
    - Минусы:
      - Не удаётся обнаружить сложное ВПО
      - Не удается масштабировать большой набор приложений
8. Основанный на IoT
    - Плюсы:
      - Может использовать как статические, так и динамические функции
    - Минусы:
      - Не удается обнаруживать сложное ВПО

В статье "Kernel-level Rootkit Detection, Prevention and Behavior Profiling: A Taxonomy and Survey" Nadim Mohammad, Lee Wonjun, Akopian David
приводят таксономию обнаружения руткитов уровня ядра, в добавок к вышеперечисленным методам обнаружения руткитов, можно указать на обнаружение
на основе целостности и обнаружение на основе перекрестного просмотра.
- Обнаружение на основе целостности:
  - Целостность статической области
    - Попытка доступа к разделу только для чтения в памяти
    - Хеширование известного региона памяти
    - Политика контроля доступа
    - Динамическое трассирование на уровне страниц
  - Динамическая целостность региона
    - Проверка указателей на функции
    - Разделение распределения данных ядра
    - Безопасное отображение страниц
    - Модель поведения, основанная на событиях

В статье "Countering Malware Via Decoy Processes with Improved Resource Utilization Consistency", исследователи Sutton Sara,
Bond Benjamin, Tahiri Sementa и Rrushi Julian проводят работу по применению приманок для борьбы с вредоносными программами.
Основной целью исследования является повышение эффективности приманок в обнаружении и противодействии руткитам и другим 
видам вредоносных программ. В работе предлагается использовать машинное обучение и механизм обучения с использованием карты
теплового изображения (heatmap) для улучшения согласованности использования ресурсов приманок.
Подход исследователей заключается в создании ложных процессов (приманок), которые имитируют поведение реальных процессов,
и обучении их на основе данных о реальных процессах. Таким образом, приманки становятся более реалистичными и 
чувствительными к изменениям в системе, что позволяет выявлять скрытые вредоносные программы.
Эксперименты исследования проводились на машинах в производственной среде, включая процессы OPC-клиента. Результаты показали,
что улучшенные приманки демонстрируют динамику использования ресурсов, которая практически неразличима от реальных процессов.
Это свидетельствует о повышении эффективности метода обнаружения руткитов и других вредоносных программ с использованием приманок.

В статье "MOSKG: countering kernel rootkits with a secure paging mechanism" ученые Yan Guanglu, Luo Senlin,
Feng Fan, Pan Limin, Safi Qamas Gul Khan разработали "MOSKG"(сделать сноску - "Безопасный механизм пейджинга" относится к системе управления виртуальной памятью в компьютерных операционных системах.
Основная идея "безопасного механизма пейджинга" состоит в том, чтобы обеспечить безопасность и конфиденциальность данных, которые хранятся в виртуальной памяти, особенно когда происходит обмен данными между виртуальной и физической памятью.)
, представляющий собой прозрачную архитектуру для противодействия руткитам. 
MOSKG (Multiple Operating Systems Kernel Guard) - это система защиты ядра для борьбы с rootkit'ами, предназначенная для множества операционных систем. Её характеристики включают:
- Прозрачная архитектура: Все компоненты MOSKG находятся в гипервизоре и не видимы для вредоносных программ, что обеспечивает их изоляцию и безопасность. </br>
(сноска для Гипервизор (англ. hypervisor) — программное обеспечение или слой абстракции, который обеспечивает виртуализацию и управление виртуальными машинами на физическом аппаратном оборудовании.) 
- Отсутствие ограничений на целевую ОС: MOSKG не ограничивает тип операционной системы, что позволяет применять её на различных платформах и архитектурах.
- Абсолютная защита для защитника: Система обеспечивает надежную защиту и изоляцию для своих компонентов, что предотвращает их компрометацию злоумышленниками.
- Приемлемое влияние на производительность: Введение MOSKG не вносит существенной перегрузки, что обеспечивает приемлемую производительность системы.
- Фокус на защите во время выполнения: MOSKG ориентирована на обеспечение защиты виртуальных машин во время их работы, что повышает безопасность системы.
- Доверенная вычислительная база: Аппаратное обеспечение и гипервизор считаются частями доверенной вычислительной базы, что повышает общую надежность системы.
- Безопасная загрузка: MOSKG предполагает, что машина может выполнить безопасную загрузку, что обеспечивает дополнительный уровень защиты.
- Активация до экспозиции целевой ОС зловредному коду: MOSKG активируется до того, как целевая операционная система сталкивается с вредоносным кодом, что увеличивает эффективность её защиты.

MOSKG представляет собой эффективный и безопасный механизм обнаружения и противодействия rootkit'ам, работая на различных операционных системах и обеспечивая надежную защиту во время выполнения.

В статье "ULTRA: Ultimate Rootkit Detection over the Air" учёными Pham Duy-Phuc, Marion Damien, Heuser Annelie предлагается фреймворк ULTRA. </br>
ULTRA (ULTimate Rootkit classification and detection over the Air) - это система классификации и обнаружения rootkit'ов,
которая использует электромагнитные отклонения (EM trace) и приманки для анализа скрытых (неактивных) rootkit'ов на устройствах. 
Система работает в черном ящике, где аналитик не имеет предварительных знаний о наличии rootkit'а. ULTRA использует приманки
на устройстве для вызова поведения rootkit'ов и обнаружения их характеристик. После предварительной обработки данных система 
обучает нейронные сети и алгоритмы машинного обучения для обнаружения и классификации rootkit'ов в различных практических сценариях.
В статье говорится, что тестирование происходило на ОС Linux, но использование метода ULTRA (ULTimate Rootkit classification and detection over the Air)
возможно не только в среде Linux, но и в ОС Windows. Ключевой особенностью ULTRA является то, что она использует электромагнитные отклонения (EM trace)
и приманки для анализа rootkit'ов, а не зависит от конкретной операционной системы.
Электромагнитные отклонения и поведение rootkit'ов являются характеристиками аппаратного и программного взаимодействия и,
следовательно, не зависят от операционной системы. Приманки также могут быть разработаны таким образом, чтобы вызвать
поведение rootkit'ов на устройстве, независимо от того, работает оно на Linux или Windows.
Таким образом, метод ULTRA может быть адаптирован и применен для обнаружения rootkit'ов в 
различных операционных системах, включая Windows.